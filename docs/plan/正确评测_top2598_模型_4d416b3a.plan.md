---
name: 正确评测 top2598 模型
overview: 使用 evaluate.sh 已有的 --dict_dir 参数对 top2598 模型进行正确评测（无需改脚本），并修复 run_fsmn_ctc.sh Stage 3 的 dict 传参缺失（2 行改动，兼容所有实验）。
todos:
  - id: eval-top2598
    content: 用 evaluate.sh --dict_dir dict_top2598 对 top2598 模型进行正确评测，验证 FRR 是否大幅下降
    status: in_progress
  - id: fix-stage3-dict
    content: 在 run_fsmn_ctc.sh Stage 3 的 score_ctc.py 和 compute_det_ctc.py 调用中加上 --dict $dict_dir（共 2 行）
    status: pending
isProject: false
---

# 正确评测 top2598 模型

## 现状分析

- `evaluate.sh` **已支持** `--dict_dir` 参数，且正确传递给 `score_ctc.py` 和 `compute_det_ctc.py` -- 无需改动
- `run_fsmn_ctc.sh` Stage 3 的两处调用**缺少** `--dict $dict_dir` -- 需要加 2 行

## 步骤 1：直接用 evaluate.sh 正确评测（零改动）

```bash
cd examples/hi_xiaowen/s0

# 用 top2598 的 dict 评测（选一个 checkpoint，例如 79.pt）
bash evaluate.sh \
  --checkpoint exp/fsmn_ctc_top2598/79.pt \
  --dict_dir dict_top2598 \
  --dataset test \
  --gpu 0
```

结果会写入 `exp/fsmn_ctc_top2598/test_79/`，然后用 `analyze_exp_test_stats.py` 查看：

```bash
python analyze_exp_test_stats.py --test-id 79
```

这一步不改任何代码，纯调用参数变化。如果 FRR 从 99% 大幅下降，就确认了"评测 dict 不一致"是主因。

## 步骤 2：修复 run_fsmn_ctc.sh Stage 3（2 行改动）

在 [`run_fsmn_ctc.sh`](examples/hi_xiaowen/s0/run_fsmn_ctc.sh) 第 246-265 行的两处 python 调用中各加一行 `--dict $dict_dir \`，使 Stage 3 也能自动使用正确的 dict：

**改动 1**（score_ctc.py 调用，约第 252 行后）：加 `--dict $dict_dir \`

**改动 2**（compute_det_ctc.py 调用，约第 263 行后）：加 `--dict $dict_dir \`

改完后 Stage 3 就自动跟随 `--dict_dir` 参数，所有实验兼容，调用方式不变。